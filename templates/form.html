{% extends "base.html" %}
{% block content %}
  <h1>{% if post %}投稿を編集{% else %}新規投稿{% endif %}</h1>
  <form method="post" enctype="multipart/form-data">
    <input type="text" name="title" placeholder="タイトル" value="{{ post.title if post else '' }}">
    <div id="editor" style="min-height:240px;">
      {% if post %}{{ post.content | safe }}{% endif %}
    </div>
    <input type="hidden" name="content" id="hiddenContent">

    <p style="margin-top:12px">
      画像を選択（任意）：
      <input type="file" name="image" accept="image/*">
      {% if post and post.image_filename %}
        <br>現在の画像: {{ post.image_filename }}
        <img src="{{ url_for('static', filename='uploads/' ~ post.image_filename) }}" width="200">
      {% endif %}
    </p>

    <p style="margin-top:12px">
      <button class="btn" type="submit">{% if post %}更新{% else %}投稿{% endif %}</button>
      <a href="{{ url_for('index') }}" style="margin-left:12px">キャンセル</a>
    </p>
  </form>
{% endblock %}

{% block scripts %}
<script>
  var quill = new Quill('#editor', { theme: 'snow' });
  var form = document.querySelector('form');
  form.onsubmit = function() {
    var hidden = document.querySelector('#hiddenContent');
    hidden.value = quill.root.innerHTML;
  };
</script>
{% endblock %}
